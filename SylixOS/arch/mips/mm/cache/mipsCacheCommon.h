/*********************************************************************************************************
**
**                                    中国软件开源组织
**
**                                   嵌入式实时操作系统
**
**                                       SylixOS(TM)
**
**                               Copyright  All Rights Reserved
**
**--------------文件信息--------------------------------------------------------------------------------
**
** 文   件   名: mipsCacheCommon.h
**
** 创   建   人: Jiao.JinXing (焦进星)
**
** 文件创建日期: 2017 年 07 月 18 日
**
** 描        述: MIPS R4K 体系构架 CACHE 驱动.
*********************************************************************************************************/

#ifndef __ARCH_MIPSCACHECOMMON_H
#define __ARCH_MIPSCACHECOMMON_H

/*********************************************************************************************************
  CACHE 状态
*********************************************************************************************************/
#define L1_CACHE_I_EN       0x01
#define L1_CACHE_D_EN       0x02
#define L1_CACHE_EN         (L1_CACHE_I_EN | L1_CACHE_D_EN)
#define L1_CACHE_DIS        0x00
/*********************************************************************************************************
  CACHE 获得 pvAdrs 与 pvEnd 位置
*********************************************************************************************************/
#define MIPS_CACHE_GET_END(pvAdrs, stBytes, ulEnd, uiLineSize)              \
        do {                                                                \
            ulEnd  = (addr_t)((size_t)pvAdrs + stBytes);                    \
            pvAdrs = (PVOID)((addr_t)pvAdrs & ~((addr_t)uiLineSize - 1));   \
        } while (0)
/*********************************************************************************************************
  CACHE 回写管线
*********************************************************************************************************/
#define MIPS_PIPE_FLUSH()   KN_SYNC()
/*********************************************************************************************************
  CACHE 信息
*********************************************************************************************************/
typedef struct {
    BOOL        CACHE_bPresent;                                         /*  是否存在 CACHE              */
    UINT32      CACHE_uiSize;                                           /*  CACHE 大小                  */
    UINT32      CACHE_uiLineSize;                                       /*  CACHE 行大小                */
    UINT32      CACHE_uiSetNr;                                          /*  组数                        */
    UINT32      CACHE_uiWayNr;                                          /*  路数                        */
    UINT32      CACHE_uiWayStep;                                        /*  路步进                      */
    UINT32      CACHE_uiWayBit;                                         /*  索引选路偏移                */
} MIPS_CACHE;

#endif                                                                  /*  __ARCH_MIPSCACHECOMMON_H    */
/*********************************************************************************************************
  END
*********************************************************************************************************/
